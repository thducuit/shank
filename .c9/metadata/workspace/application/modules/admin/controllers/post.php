{"filter":false,"title":"post.php","tooltip":"/application/modules/admin/controllers/post.php","undoManager":{"mark":52,"position":52,"stack":[[{"start":{"row":1,"column":0},"end":{"row":7,"column":0},"action":"remove","lines":["/**"," * Created by PhpStorm."," * User: Tuan Anh"," * Date: 8/12/15"," * Time: 7:17 AM"," */",""],"id":30},{"start":{"row":1,"column":0},"end":{"row":1,"column":9},"action":"insert","lines":["//REQUIRE"]}],[{"start":{"row":0,"column":0},"end":{"row":13,"column":1},"action":"remove","lines":["<?php","//REQUIRE","if ( ! defined('BASEPATH')) exit('No direct script access allowed');","class Post_Admin_Controller extends Base_Admin_Controller {","    function __construct(){","        //if i remove this parent::__construct(); the error is gone","        parent::__construct();","        $this->template->set_theme('admin_theme');","        $this->template->set_layout('one_col');","        $this->template->set_partial('header','header');","        $this->template->set_partial('footer','footer');","        $this->lang->load(ADMIN_LANGUAGE, ADMIN_LANGUAGE);","    }","}"],"id":32},{"start":{"row":0,"column":0},"end":{"row":307,"column":1},"action":"insert","lines":["<?php","//REQUIRE","require_once APPPATH . 'modules/admin/controllers/base_admin_controller.php';","require_once APPPATH . \"modules/admin/controllers/inputs/category_inputs.php\";","","if ( ! defined('BASEPATH')) exit('No direct script access allowed');","class Category extends Base_Admin_Controller {","    ","    private $module;","    private $languages;","    private $class_view;","    private $url;","    private $params;","    private $data;","    ","    ","    ","    /**","     * CONSTRUCT ","     * ","     */","    function __construct(){","        ","        parent::__construct();","        ","        $this->data = array();","        ","        $this->module = array();","        ","        //GET VIEW","        $this->class_view = $this->router->fetch_class() . \"/\" . $this->router->fetch_method();","        ","        //GET CURENT URL","        $this->url = $this->module_url();","        ","        //GET LANGUAGES","        $this->languages = $this->languages();","        ","        //GET PARAMS","        $this->params = $this->request_params( new Category_inputs );","        ","        //ADD PARAMS TO VIEW","        $this->data['params'] = $this->params;","        ","        //GET MODULE","        $this->module = $this->module();","        ","        //SET TITLE FOR VIEW","        $this->template->title( ( !empty($this->module->module_name) ) ? $this->module->module_name : 'Category' );","    }","    ","    ","    ","    /**","     * INDEX ACTION ","     * ","     */","    public function index () {","        $this->load->Model(\"category_admin_model\");","        $this->load->helper('select');","        $this->load->helper('button');","        $this->load->helper('sort_input');","        $this->load->helper('pagination');","        $this->load->helper('utility');","        ","        //SELECT","        $select = array('category_id', 'category_title', 'category_order', 'category_status', 'language_id', 'catparent_id', 'category_level');","        //FILTER","        $filters = array('catparent_id' => (int)$this->params['pid']);","        $filters['language_id'] =  ADMIN_LANGUAGE;","        if( (int)$this->params['show'] != -1 ) {","            $filters['category_status'] = (int)$this->params['show'];","        }","        $filters['category_module'] = $this->module_code();","        //ORDER","        $orders = array('category_order' => 'asc');","        ","        //PAGINATION","        $page = (int)$this->params['page'];","        $range = (int)$this->params['range'];","        $from = ($page - 1) * $range;","        ","        //DATA TO VIEW","        $this->data['list'] = $this->category_admin_model->list_all_by_paging( $select, $filters, $orders, $from, $range, $keyword = $this->params['keyword'] );","        ","        //GET LIST SORT","        $filters = array( 'category_status' => 1,  'category_module' => $this->module_code() );","        $rs = $this->category_admin_model->list_all( $select, $filters, $orders );","        $this->data['list_sort'] = get_list_by_language_id(ADMIN_LANGUAGE, $rs);","        ","        //RUN VIEW","        $this->template->build( $this->class_view, $this->data);","    }","    ","    ","    ","    /**","     * ADD ACTION ","     * ","     */","    public function add() {","        $this->load->Model(\"category_admin_model\");","        $this->load->Model(\"langmap_admin_model\");","        $this->load->Model(\"alias_admin_model\");","        $this->load->helper('alias');","        $this->load->helper('utility');","        $this->load->helper('select');","        $category = array();","        ","        //IF SUBMITED","        if ( isset($_POST['add']) ) {","            //ADD NEW LANG MAP","            $langmap_id = (int)$this->langmap_admin_model->insert( array('langmap_module' => $this->module_code() ) );","        ","            //GET DATA FROM POST","            $categories = $this->input->post('category');","            $status = $this->input->post('status');","            $order = $this->input->post('order');","            ","            foreach($this->languages as $lang) {","                $category = $categories[$lang['language_id']];","                $category['status'] = $status;","                $category['order'] = $order;","                $category['language_id'] = $lang['language_id'];","                $category['langmap_id'] = $langmap_id;","                $category['module'] = $this->module_code();","                $category['alias'] = ( !empty( $category['alias'] ) ) ? $category['alias'] : alias( $category['title'] );","                ","                //INSERT CATEGORY","                $category_id = $this->category_admin_model->insert( $category );","                ","                //INSERT ALIAS","                $this->alias_admin_model->insert($category_id, $category);","            }","            ","            //BACK TO INDEX","            redirect( url_add_params($this->params, '/admin/category') );","        } else {","            $this->data['languages'] = $this->languages;","            $this->data['list'] = array();","            ","            //GET LIST","            $rs = $this->category_admin_model->list_all( $select = array( 'category_id', 'category_title', 'catparent_id', 'category_level', 'language_id'),","                                                         $filters = array( 'category_status' => 1,  'category_module' => $this->module_code() ),","                                                         $orders = array() ","                                                       );","            foreach($this->languages as $l) {","                $this->data['list'][$l['language_id']] = get_list_by_language_id($l['language_id'], $rs);","            }","            ","            //RUN VIEW","            $this->template->build( $this->class_view, $this->data);","        }","    }","    ","    ","    ","    /**","     * EDIT ACTION","     * ","     */","    public function edit() {","        $this->load->Model(\"category_admin_model\");","        $this->load->Model(\"langmap_admin_model\");","        $this->load->Model(\"alias_admin_model\");","        $this->load->helper('alias');","        $this->load->helper('utility');","        $this->load->helper('select');","        $category = array();","        $this->data['categories'] = array();","        $this->data['languages'] = $this->languages;","        ","        //IF SUBMITED","        if ( isset($_POST['update']) ) {","            //GET DATA FROM POST","            $categories = $this->input->post('category');","            $status = $this->input->post('status');","            $order = $this->input->post('order');","            //_pr($categories); die();","            foreach($this->languages as $lang) {","                $category = $categories[$lang['language_id']];","                $category['status'] = $status;","                $category['order'] = $order;","                $category['alias'] = ( !empty( $category['alias'] ) ) ? $category['alias'] : alias( $category['title'] );","                ","                //UPDATE CATEGORY","                $this->category_admin_model->update( $category );","                ","                //UPDATE ALIAS","                $this->alias_admin_model->update( $category );","            }","            ","            //BACK TO INDEX","            redirect( url_add_params($this->params, '/admin/category') );","        }else{","            //GET CATEGORIES TO SHOW","            $id = $this->input->get('id');","            $category   = $this->category_admin_model->get_by_id($id);","            $langmap_id = $category->langmap_id;","            $rs = $this->category_admin_model->get_by_langmap_id($langmap_id);","            foreach($this->languages as $l) {","                $this->data['categories'][$l['language_id']] = get_list_by_language_id($l['language_id'], $rs, true);","            }","            ","            //GET LIST","            $rs = $this->category_admin_model->list_all( ","                                                        $select = array( 'category_id', 'category_title', 'catparent_id', 'category_level', 'language_id'),","                                                        $filters = array( 'category_status' => 1,  'category_module' => $this->module_code() ),","                                                        $orders = array() ","                                                        );","            foreach($this->languages as $l) {","                $this->data['list'][$l['language_id']] = get_list_by_language_id($l['language_id'], $rs);","            }","            ","            //RUN VIEW","            $this->template->build( $this->class_view, $this->data);","        }","    }","    ","    ","    ","    ","    /**","     * UPDATE STATUS","     * ","     */","    public function status() {","        $this->load->Model(\"category_admin_model\");","        ","        //GET DATA","        $status = (int)$this->input->get('status');","        $id = (int)$this->input->get('id');","        ","        //GET LANGMAP ID","        $category = $this->category_admin_model->get_by_id($id);","        $langmap_id = $category->langmap_id;","        ","        //UPDATE DATA","        $args = array('category_status' => $status);","        $result = $this->category_admin_model->update_by_langmap_id( $args, $langmap_id );","        ","        //RESPONSE","        echo json_encode( array('STATUS' => $result) );","    }","    ","    ","    ","    /**","     * UPDATE","     * ","     */","    public function update() {","        $this->load->Model(\"category_admin_model\");","        $this->load->Model(\"alias_admin_model\");","        $this->load->helper('utility');","        $type = $this->input->post('type');","        $sorts = array();","        $ids = array();","        if( $type == 'update' ) {","            $sorts = $this->input->post('sorts');","            if( count($sorts) > 0 ) {","                foreach($sorts as $id => $value) {","                    //GET LANGMAP ID","                    $category = $this->category_admin_model->get_by_id($id);","                    $langmap_id = $category->langmap_id;","                    ","                    //UPDATE DATA","                    $args = array('category_order' => $value);","                    $this->category_admin_model->update_by_langmap_id( $args, $langmap_id );","                }","            }","        } elseif ( $type == 'delete' ) {","            $ids = $this->input->post('ids');","            if( count($ids) > 0 ) {","                foreach($ids as $id) {","                    //GET LANGMAP ID","                    $category = $this->category_admin_model->get_by_id($id);","                    $langmap_id = $category->langmap_id;","                    ","                    $categories = $this->category_admin_model->get_by_langmap_id($langmap_id);","                    ","                    //DELETE DATA","                    $this->category_admin_model->delete_by_langmap_id( $langmap_id );","                    ","                    //DELETE ALIAS","                    foreach($categories as $cat) {","                        $alias_id = $cat['alias_id'];","                        $this->alias_admin_model->delete_by_id($alias_id);","                    }","                }","            }","        }","        ","        //BACK TO INDEX","        redirect( url_add_params($this->params, '/admin/category') );","    }","    ","    ","    ","    /**","     * DELETE","     * ","     */","    public function delete() {","        $id = $this->input->get('id');","        _pr($id, true);","    }","}"]}],[{"start":{"row":3,"column":57},"end":{"row":3,"column":65},"action":"remove","lines":["category"],"id":33},{"start":{"row":3,"column":57},"end":{"row":3,"column":58},"action":"insert","lines":["p"]}],[{"start":{"row":3,"column":58},"end":{"row":3,"column":59},"action":"insert","lines":["o"],"id":34}],[{"start":{"row":3,"column":59},"end":{"row":3,"column":60},"action":"insert","lines":["s"],"id":35}],[{"start":{"row":3,"column":60},"end":{"row":3,"column":61},"action":"insert","lines":["t"],"id":36}],[{"start":{"row":6,"column":6},"end":{"row":6,"column":14},"action":"remove","lines":["Category"],"id":37},{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"insert","lines":["P"]}],[{"start":{"row":6,"column":7},"end":{"row":6,"column":8},"action":"insert","lines":["o"],"id":38}],[{"start":{"row":6,"column":8},"end":{"row":6,"column":9},"action":"insert","lines":["s"],"id":39}],[{"start":{"row":6,"column":9},"end":{"row":6,"column":10},"action":"insert","lines":["t"],"id":40}],[{"start":{"row":48,"column":103},"end":{"row":48,"column":111},"action":"remove","lines":["Category"],"id":41},{"start":{"row":48,"column":103},"end":{"row":48,"column":104},"action":"insert","lines":["P"]}],[{"start":{"row":48,"column":104},"end":{"row":48,"column":105},"action":"insert","lines":["o"],"id":42}],[{"start":{"row":48,"column":105},"end":{"row":48,"column":106},"action":"insert","lines":["s"],"id":43}],[{"start":{"row":48,"column":106},"end":{"row":48,"column":107},"action":"insert","lines":["t"],"id":44}],[{"start":{"row":91,"column":64},"end":{"row":91,"column":66},"action":"insert","lines":["*/"],"id":45},{"start":{"row":58,"column":8},"end":{"row":58,"column":10},"action":"insert","lines":["/*"]}],[{"start":{"row":39,"column":51},"end":{"row":39,"column":59},"action":"remove","lines":["Category"],"id":46},{"start":{"row":39,"column":51},"end":{"row":39,"column":52},"action":"insert","lines":["P"]}],[{"start":{"row":39,"column":52},"end":{"row":39,"column":53},"action":"insert","lines":["o"],"id":47}],[{"start":{"row":39,"column":53},"end":{"row":39,"column":54},"action":"insert","lines":["s"],"id":48}],[{"start":{"row":39,"column":54},"end":{"row":39,"column":55},"action":"insert","lines":["t"],"id":49}],[{"start":{"row":101,"column":8},"end":{"row":101,"column":11},"action":"insert","lines":["// "],"id":50},{"start":{"row":102,"column":8},"end":{"row":102,"column":11},"action":"insert","lines":["// "]},{"start":{"row":103,"column":8},"end":{"row":103,"column":11},"action":"insert","lines":["// "]},{"start":{"row":104,"column":8},"end":{"row":104,"column":11},"action":"insert","lines":["// "]},{"start":{"row":105,"column":8},"end":{"row":105,"column":11},"action":"insert","lines":["// "]},{"start":{"row":106,"column":8},"end":{"row":106,"column":11},"action":"insert","lines":["// "]},{"start":{"row":107,"column":8},"end":{"row":107,"column":11},"action":"insert","lines":["// "]},{"start":{"row":109,"column":8},"end":{"row":109,"column":11},"action":"insert","lines":["// "]},{"start":{"row":110,"column":8},"end":{"row":110,"column":11},"action":"insert","lines":["// "]},{"start":{"row":111,"column":8},"end":{"row":111,"column":11},"action":"insert","lines":["// "]},{"start":{"row":112,"column":8},"end":{"row":112,"column":11},"action":"insert","lines":["// "]},{"start":{"row":114,"column":8},"end":{"row":114,"column":11},"action":"insert","lines":["// "]},{"start":{"row":115,"column":8},"end":{"row":115,"column":11},"action":"insert","lines":["// "]},{"start":{"row":116,"column":8},"end":{"row":116,"column":11},"action":"insert","lines":["// "]},{"start":{"row":117,"column":8},"end":{"row":117,"column":11},"action":"insert","lines":["// "]},{"start":{"row":119,"column":8},"end":{"row":119,"column":11},"action":"insert","lines":["// "]},{"start":{"row":120,"column":8},"end":{"row":120,"column":11},"action":"insert","lines":["// "]},{"start":{"row":121,"column":8},"end":{"row":121,"column":11},"action":"insert","lines":["// "]},{"start":{"row":122,"column":8},"end":{"row":122,"column":11},"action":"insert","lines":["// "]},{"start":{"row":123,"column":8},"end":{"row":123,"column":11},"action":"insert","lines":["// "]},{"start":{"row":124,"column":8},"end":{"row":124,"column":11},"action":"insert","lines":["// "]},{"start":{"row":125,"column":8},"end":{"row":125,"column":11},"action":"insert","lines":["// "]},{"start":{"row":126,"column":8},"end":{"row":126,"column":11},"action":"insert","lines":["// "]},{"start":{"row":128,"column":8},"end":{"row":128,"column":11},"action":"insert","lines":["// "]},{"start":{"row":129,"column":8},"end":{"row":129,"column":11},"action":"insert","lines":["// "]},{"start":{"row":131,"column":8},"end":{"row":131,"column":11},"action":"insert","lines":["// "]},{"start":{"row":132,"column":8},"end":{"row":132,"column":11},"action":"insert","lines":["// "]},{"start":{"row":133,"column":8},"end":{"row":133,"column":11},"action":"insert","lines":["// "]},{"start":{"row":135,"column":8},"end":{"row":135,"column":11},"action":"insert","lines":["// "]},{"start":{"row":136,"column":8},"end":{"row":136,"column":11},"action":"insert","lines":["// "]},{"start":{"row":137,"column":8},"end":{"row":137,"column":11},"action":"insert","lines":["// "]},{"start":{"row":138,"column":8},"end":{"row":138,"column":11},"action":"insert","lines":["// "]},{"start":{"row":139,"column":8},"end":{"row":139,"column":11},"action":"insert","lines":["// "]},{"start":{"row":141,"column":8},"end":{"row":141,"column":11},"action":"insert","lines":["// "]},{"start":{"row":142,"column":8},"end":{"row":142,"column":11},"action":"insert","lines":["// "]},{"start":{"row":143,"column":8},"end":{"row":143,"column":11},"action":"insert","lines":["// "]},{"start":{"row":144,"column":8},"end":{"row":144,"column":11},"action":"insert","lines":["// "]},{"start":{"row":145,"column":8},"end":{"row":145,"column":10},"action":"insert","lines":["//"]},{"start":{"row":146,"column":8},"end":{"row":146,"column":11},"action":"insert","lines":["// "]},{"start":{"row":147,"column":8},"end":{"row":147,"column":11},"action":"insert","lines":["// "]},{"start":{"row":148,"column":8},"end":{"row":148,"column":11},"action":"insert","lines":["// "]},{"start":{"row":150,"column":8},"end":{"row":150,"column":11},"action":"insert","lines":["// "]},{"start":{"row":151,"column":8},"end":{"row":151,"column":11},"action":"insert","lines":["// "]},{"start":{"row":152,"column":8},"end":{"row":152,"column":11},"action":"insert","lines":["// "]}],[{"start":{"row":151,"column":8},"end":{"row":151,"column":10},"action":"remove","lines":["//"],"id":51}],[{"start":{"row":151,"column":8},"end":{"row":151,"column":12},"action":"insert","lines":["    "],"id":52}],[{"start":{"row":151,"column":8},"end":{"row":151,"column":12},"action":"remove","lines":["    "],"id":53}],[{"start":{"row":151,"column":8},"end":{"row":151,"column":9},"action":"insert","lines":[" "],"id":54}],[{"start":{"row":151,"column":9},"end":{"row":151,"column":10},"action":"insert","lines":[" "],"id":55}],[{"start":{"row":150,"column":9},"end":{"row":150,"column":10},"action":"remove","lines":["/"],"id":56}],[{"start":{"row":150,"column":8},"end":{"row":150,"column":9},"action":"remove","lines":["/"],"id":57}],[{"start":{"row":150,"column":8},"end":{"row":150,"column":12},"action":"insert","lines":["    "],"id":58}],[{"start":{"row":150,"column":8},"end":{"row":150,"column":12},"action":"remove","lines":["    "],"id":59}],[{"start":{"row":150,"column":8},"end":{"row":150,"column":9},"action":"insert","lines":[" "],"id":60}],[{"start":{"row":150,"column":9},"end":{"row":150,"column":10},"action":"insert","lines":[" "],"id":61}],[{"start":{"row":150,"column":8},"end":{"row":150,"column":9},"action":"insert","lines":["/"],"id":66}],[{"start":{"row":150,"column":9},"end":{"row":150,"column":10},"action":"insert","lines":["/"],"id":67}],[{"start":{"row":151,"column":8},"end":{"row":151,"column":9},"action":"insert","lines":["/"],"id":68}],[{"start":{"row":151,"column":9},"end":{"row":151,"column":10},"action":"insert","lines":["/"],"id":69}],[{"start":{"row":101,"column":8},"end":{"row":101,"column":11},"action":"remove","lines":["// "],"id":71},{"start":{"row":102,"column":8},"end":{"row":102,"column":11},"action":"remove","lines":["// "]},{"start":{"row":103,"column":8},"end":{"row":103,"column":11},"action":"remove","lines":["// "]},{"start":{"row":104,"column":8},"end":{"row":104,"column":11},"action":"remove","lines":["// "]},{"start":{"row":105,"column":8},"end":{"row":105,"column":11},"action":"remove","lines":["// "]},{"start":{"row":106,"column":8},"end":{"row":106,"column":11},"action":"remove","lines":["// "]},{"start":{"row":107,"column":8},"end":{"row":107,"column":11},"action":"remove","lines":["// "]},{"start":{"row":109,"column":8},"end":{"row":109,"column":11},"action":"remove","lines":["// "]},{"start":{"row":110,"column":8},"end":{"row":110,"column":11},"action":"remove","lines":["// "]},{"start":{"row":111,"column":8},"end":{"row":111,"column":11},"action":"remove","lines":["// "]},{"start":{"row":112,"column":8},"end":{"row":112,"column":11},"action":"remove","lines":["// "]},{"start":{"row":114,"column":8},"end":{"row":114,"column":11},"action":"remove","lines":["// "]},{"start":{"row":115,"column":8},"end":{"row":115,"column":11},"action":"remove","lines":["// "]},{"start":{"row":116,"column":8},"end":{"row":116,"column":11},"action":"remove","lines":["// "]},{"start":{"row":117,"column":8},"end":{"row":117,"column":11},"action":"remove","lines":["// "]},{"start":{"row":119,"column":8},"end":{"row":119,"column":11},"action":"remove","lines":["// "]},{"start":{"row":120,"column":8},"end":{"row":120,"column":11},"action":"remove","lines":["// "]},{"start":{"row":121,"column":8},"end":{"row":121,"column":11},"action":"remove","lines":["// "]},{"start":{"row":122,"column":8},"end":{"row":122,"column":11},"action":"remove","lines":["// "]},{"start":{"row":123,"column":8},"end":{"row":123,"column":11},"action":"remove","lines":["// "]},{"start":{"row":124,"column":8},"end":{"row":124,"column":11},"action":"remove","lines":["// "]},{"start":{"row":125,"column":8},"end":{"row":125,"column":11},"action":"remove","lines":["// "]},{"start":{"row":126,"column":8},"end":{"row":126,"column":11},"action":"remove","lines":["// "]},{"start":{"row":128,"column":8},"end":{"row":128,"column":11},"action":"remove","lines":["// "]},{"start":{"row":129,"column":8},"end":{"row":129,"column":11},"action":"remove","lines":["// "]},{"start":{"row":131,"column":8},"end":{"row":131,"column":11},"action":"remove","lines":["// "]},{"start":{"row":132,"column":8},"end":{"row":132,"column":11},"action":"remove","lines":["// "]},{"start":{"row":133,"column":8},"end":{"row":133,"column":11},"action":"remove","lines":["// "]},{"start":{"row":135,"column":8},"end":{"row":135,"column":11},"action":"remove","lines":["// "]},{"start":{"row":136,"column":8},"end":{"row":136,"column":11},"action":"remove","lines":["// "]},{"start":{"row":137,"column":8},"end":{"row":137,"column":11},"action":"remove","lines":["// "]},{"start":{"row":138,"column":8},"end":{"row":138,"column":11},"action":"remove","lines":["// "]},{"start":{"row":139,"column":8},"end":{"row":139,"column":11},"action":"remove","lines":["// "]},{"start":{"row":141,"column":8},"end":{"row":141,"column":11},"action":"remove","lines":["// "]},{"start":{"row":142,"column":8},"end":{"row":142,"column":11},"action":"remove","lines":["// "]},{"start":{"row":143,"column":8},"end":{"row":143,"column":11},"action":"remove","lines":["// "]},{"start":{"row":144,"column":8},"end":{"row":144,"column":11},"action":"remove","lines":["// "]},{"start":{"row":145,"column":8},"end":{"row":145,"column":11},"action":"remove","lines":["// "]},{"start":{"row":146,"column":8},"end":{"row":146,"column":11},"action":"remove","lines":["// "]},{"start":{"row":147,"column":8},"end":{"row":147,"column":11},"action":"remove","lines":["// "]},{"start":{"row":148,"column":8},"end":{"row":148,"column":11},"action":"remove","lines":["// "]},{"start":{"row":150,"column":8},"end":{"row":150,"column":11},"action":"remove","lines":["// "]},{"start":{"row":151,"column":8},"end":{"row":151,"column":11},"action":"remove","lines":["// "]},{"start":{"row":152,"column":8},"end":{"row":152,"column":11},"action":"remove","lines":["// "]}],[{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"remove","lines":["    "],"id":72},{"start":{"row":151,"column":0},"end":{"row":151,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":150,"column":10},"end":{"row":150,"column":12},"action":"insert","lines":["  "],"id":73}],[{"start":{"row":151,"column":10},"end":{"row":151,"column":12},"action":"insert","lines":["  "],"id":74}],[{"start":{"row":101,"column":51},"end":{"row":102,"column":0},"action":"insert","lines":["",""],"id":75},{"start":{"row":102,"column":0},"end":{"row":102,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":102,"column":8},"end":{"row":102,"column":51},"action":"insert","lines":["$this->load->Model(\"category_admin_model\");"],"id":76}],[{"start":{"row":102,"column":28},"end":{"row":102,"column":36},"action":"remove","lines":["category"],"id":77},{"start":{"row":102,"column":28},"end":{"row":102,"column":29},"action":"insert","lines":["p"]}],[{"start":{"row":102,"column":29},"end":{"row":102,"column":30},"action":"insert","lines":["o"],"id":78}],[{"start":{"row":102,"column":30},"end":{"row":102,"column":31},"action":"insert","lines":["s"],"id":79}],[{"start":{"row":102,"column":31},"end":{"row":102,"column":32},"action":"insert","lines":["t"],"id":80}],[{"start":{"row":112,"column":12},"end":{"row":137,"column":73},"action":"remove","lines":["//ADD NEW LANG MAP","            $langmap_id = (int)$this->langmap_admin_model->insert( array('langmap_module' => $this->module_code() ) );","        ","            //GET DATA FROM POST","            $categories = $this->input->post('category');","            $status = $this->input->post('status');","            $order = $this->input->post('order');","            ","            foreach($this->languages as $lang) {","                $category = $categories[$lang['language_id']];","                $category['status'] = $status;","                $category['order'] = $order;","                $category['language_id'] = $lang['language_id'];","                $category['langmap_id'] = $langmap_id;","                $category['module'] = $this->module_code();","                $category['alias'] = ( !empty( $category['alias'] ) ) ? $category['alias'] : alias( $category['title'] );","                ","                //INSERT CATEGORY","                $category_id = $this->category_admin_model->insert( $category );","                ","                //INSERT ALIAS","                $this->alias_admin_model->insert($category_id, $category);","            }","            ","            //BACK TO INDEX","            redirect( url_add_params($this->params, '/admin/category') );"],"id":81}],[{"start":{"row":150,"column":12},"end":{"row":169,"column":73},"action":"remove","lines":["//GET DATA FROM POST","            $categories = $this->input->post('category');","            $status = $this->input->post('status');","            $order = $this->input->post('order');","            //_pr($categories); die();","            foreach($this->languages as $lang) {","                $category = $categories[$lang['language_id']];","                $category['status'] = $status;","                $category['order'] = $order;","                $category['alias'] = ( !empty( $category['alias'] ) ) ? $category['alias'] : alias( $category['title'] );","                ","                //UPDATE CATEGORY","                $this->category_admin_model->update( $category );","                ","                //UPDATE ALIAS","                $this->alias_admin_model->update( $category );","            }","            ","            //BACK TO INDEX","            redirect( url_add_params($this->params, '/admin/category') );"],"id":82}],[{"start":{"row":159,"column":13},"end":{"row":159,"column":15},"action":"insert","lines":["*/"],"id":83},{"start":{"row":153,"column":12},"end":{"row":153,"column":14},"action":"insert","lines":["/*"]}],[{"start":{"row":58,"column":9},"end":{"row":58,"column":10},"action":"remove","lines":["*"],"id":84}],[{"start":{"row":58,"column":8},"end":{"row":58,"column":9},"action":"remove","lines":["/"],"id":85}],[{"start":{"row":91,"column":65},"end":{"row":91,"column":66},"action":"remove","lines":["/"],"id":86}],[{"start":{"row":91,"column":64},"end":{"row":91,"column":65},"action":"remove","lines":["*"],"id":87}],[{"start":{"row":25,"column":8},"end":{"row":25,"column":30},"action":"remove","lines":["$this->data = array();"],"id":88},{"start":{"row":25,"column":8},"end":{"row":25,"column":40},"action":"insert","lines":["$this->data = $this->get_data();"]}]]},"ace":{"folds":[],"scrolltop":180,"scrollleft":0,"selection":{"start":{"row":25,"column":40},"end":{"row":25,"column":40},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":11,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1448598517683,"hash":"ad1a1edec8c6eaa9b67456efade5be4f8d39acb9"}